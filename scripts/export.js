export const DDC_moods = ['Malinconia', 'Calma', 'Felicità', 'Solitudine', 'Focus'];
export const DDC_globalBackgrounds = [
    '#FFFFFF',
    '#A8C8D8',
    '#FFFFFF',
    '#000000',
    '#1B1212'
];
export const DDC_introBackgrounds = [
    '#FFFFFF',
    '#FFFFFF',
    '#FFFFFF',
    '#000000',
    '#000000'
];
export const DDC_globalTextColors = [
    '#000000',
    '#000000',
    '#000000',
    '#FFFFFF',
    '#FFFFFF'
];
export const DDC_dictionaryLength = 12;
export const DDC_dictionary = [
    [
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-"
    ],
    [
        "Immagino di respirare a <i>pieni polmoni</i>, di sentire l'aria che entra, proprio un'<strong>armonia totale</strong> tra me e il mondo esterno, tra quello che provo dentro e quello che c’è fuori.",
        "È come se <i>l'ambiente esterno</i> e il mio stato d'animo fossero in sintonia.",
        "Quando sono calmo, mi immagino di essere proprio <i>lì nel presente</i>, senza farmi distrarre dai pensieri che vanno avanti e indietro.",
        "È L'altalena  a trasmettermi questa sensazione, perché <i>è semplicemente lì presente<i> ed è fatta per godersi quell'istante e quel piccolo pezzo di mondo con <strong>spensieratezza</strong>.",
        "Se la felicità è un'energia pazzesca, la calma è meno intensa. Ad esempio, l’acqua che bolle è un casino, finché non abbassi il gas. La calma è un po' così: <i>un grande mare piatto, intatto<i>.",
        "Mi viene in mente <strong>un giardino super ordinato</strong>, tipo quelli zen. Se c'è vita, come dei fiori o degli animali, rimane comunque una presenza silenziosa, che non rompe l'armonia.",
        "Una cosa interessante è che <i>non te ne accorgi mentre la stai vivendo</i>. In quel momento, <strong>sei totalmente immerso in ciò che stai facendo</strong>, che non noti la tranquillità della situazione, anche se, inconsciamente, la percepisci.",
        "Quando sono concentrato a leggere , avverto una profonda <strong>pace</strong>, come se la lettura creasse una barriera contro il frastuono dei miei pensieri.",
        "Se leggessi in mezzo alla natura, non sentirei di avere fretta o di dover scappare; <i>il tempo, praticamente, sparisce.</i>",
        "Il riuscire a stare a <strong>un livello basso di energia</strong> insieme a qualcun altro è più raro, ma è anche molto bello.",
        "In quel momento poi, a volte, scatta anche un po’ di felicità. Se <i>si crea quell'equilibrio tranquillo con un'altra persona</i>, spesso ti fa anche sentire felice.",
        "Non so come dire... sono i momenti in cui sei con qualcuno e riuscite a stare insieme in maniera tranquilla ed armonica che, di solito, ti <i>toccano anche un po' il cuore</i>."
    ],
    [
        "Vuoi essere solo lì, sia a livello temporale che spaziale. Non senti proprio il bisogno di essere da un'altra parte. ",
        "Dipende tanto da noi: spesso, inconsciamente, lo facciamo dipendere tanto dal resto, in realtà, è molto più legato a quanto siamo capaci di essere presenti.",
        "Mi viene da associarci tranquillità: anche se sei nel mezzo di un miliardo di cose, in quel momento sei sereno, non ti preoccupano le avversità, anzi, le sai accogliere.",
        "Non è che non ci siano, non è una bolla, ma è come se avessi delle lenti speciali che ti fanno osservare e comprendere le cose in maniera diversa. Quando succede, spesso mi dico: “Ah, ma questa cosa, in fondo, non è così complicata”.",
        "Questo è uno stato in cui sta ribollendo tutto. Quando faccio i concerti, è molto più facile che stia così, perché sta succedendo di tutto: c'è il pubblico, ci sono io, ci sono le canzoni... metteteci pure l'alcol, è una situazione dove tutta l'energia che c'è riesce a fluire.",
        "Non ci sono tappi come potrebbero esserci nell'ansia, che è quella che mi verrebbe da definire come sensazione opposta.",
        "È poi il coinvolgimento di altre persone: dall’essere con gli amici supportandosi e aiutandosi, piuttosto che all’essere con la tua famiglia e percepire l'armonia tra le generazioni.",
        "È un qualcosa che associo tanto alle persone, insomma. Può essere, non so, un villaggio felice o una situazione sociale che funziona, di convivialità.",
        "In quella sensazione, penso sia difficile avere dei problemi con quelli a cui voglio bene. Percepisco del calore, un’immagine di un piccolo villaggio o di una casa con delle luci accese all’interno... mi piace l’idea che questi posti siano popolati dalla vita.",
        "A livello naturale, sono tanti uccellini che cantano e volano, dei fiori magari, e una vegetazione rigogliosa e riccamente popolata da altri esseri viventi.",
        "Mi ricordo di quando ero sul tetto di questa casa nella giungla Giamaicana e, mentre guardavo il tramonto, tutt’intorno c'erano questi uccellini in una totale estasi. Erano circondati da tutta quella natura, quei fiori e la temperatura era perfetta.",
        "C’è sempre questo elemento vitale che va a visitare la natura,no? È sempre una questione di convivialità."
    ],
    [
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-",
        "-"
    ],
    [
            "Mi immagino un focus mode dove sei così preso  dalla situazione che non ti accorgi di come ti senti veramente. Non è per forza connesso alla calma, ma è uno stato interessante, perché  anche questo è parte della realtà,",
        "non è sempre tutto positivo o negativo, no?",
        "Quando sono davanti a un bell’impianto, con un DJ che mette la techno fatta bene e magari sono anche fatto, sento che è come se mi mettesse su una specie di binario.",
            "Può essere davvero tante cose, come una serata o anche quando mi capita di essere mega impegnato, mi sento solo e dico: “aiuto”.",
        "È come se fosse una sorta di concentrazione particolare... ma c’è lo stesso tanta energia, anche se magari non sai dove sia di preciso.",
        "È anche un pochettino più difficile da capire, però, in realtà, può essere molto comprensibile come stato. Forse, ci succede anche più spesso di quanto pensiamo.",
        "Mi immagino degli ingranaggi che vanno, dove trovi tanta energia in movimento, ma non necessariamente tocca dei punti di emotività o di incontro, non coinvolge altre persone.",
        "Lo vedo molto HD, è una matematica del mondo che ha una sua lucidità.",
        "È proprio un fluire… Lo vedi in una cascata, o nella lava di un vulcano.",
        "È accumuli di energia in quanto tale, non di energia in quanto vita.",
        "Mi viene in mente un trasporto che ha poco di elemento umano. È molto corporale ed agonistica come sensazione; senti solo l’energia allo stato puro del tuo corpo che funziona.",
        "Non è come andare a sentire il concerto dell’artista che ti piace, dove alle canzoni associ mille memorie, ma sono proprio degli ingranaggi ai quali ti agganci per farti portare via."
    ]
];
export const DDC_dynamicTags = [
    [],
    [
            "video",
        "videoaudio",
        "img",
        "img",
        "video",
        "videoaudio",
        "img",
        "video"
    ],
    [
        "video",
        "img",
        "video",
        "img",
        "video",
        "video",
        "img",
        "video"
    ],
    [],
    [ 
        "video",
        "img",
        "img",
        "img",
        "video",
        "img",
        "img",
        "video"
    ],
];
export const DDC_dynamicContents = [
    [],
    [
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/colibri.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/musicassetta-relaxing-water.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/rana.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/tabacco.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/studio.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/slang.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/pinta.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/rospo.webm"
    ]
];
export const DDC_dynamicClicked = [
    [],
    [
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/colibri.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/relaxing-water.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/rana.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/tabacco.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/studio.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/slang.webm",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/pinta.webp",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/rospo.webm"
    ]
];
export const DDC_dynamicAnimations = [
    [],
    [
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/nuvole-immersive/nuvole_nuove",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/petali/petali_",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/sole/sole_",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/nuvole-immersive/nuvole_nuove"
    ],
    [],
    [],
    [
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/tunnel/tunneltrasparente_",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/nuvole-immersive/nuvole_nuove_",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/nuvole-immersive/nuvole_nuove_",
        "https://raw.githubusercontent.com/NiccoloSegato/unverse-assets/refs/heads/main/assets/nuvole-immersive/nuvole_nuove_",
    ]
];
export const DDC_dynamicAudios = [
    [],
    [
        "",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/acqua-studio.m4a",
        "",
        "",
        "",
        "https://github.com/NiccoloSegato/unverse-assets/raw/refs/heads/main/assets/moods/calma/jamaican-slang.m4a",
        "",
        ""
    ]
];
export const DDC_objectsDidasH1 = [
    [],
    [
            "Un battito d'ali, un'eco dalla Giamaica",
        "Relaxing Water",
        "Microcosmo",
        "Materia e spirito",
        "Anatomia di un Suono",
        "Jamaican Slang",
        "Un Lento Abbraccio",
        "Piccola Meraviglia"
    ]
];
export const DDC_objectsDidasP = [
    [],
    [
            "22.04.2025, 11:12:11",
        "Nessuna data",
        "Nessuna data",
        "08.05.2025, 18:47:42",
        "31.03.2025, 13:43:40",
        "Nessuna data",
        "12.04.2025, 11:34:19",
        "22.04.2025, 19:36:22"
    ]
];
export const DDC_objectsLocations = [
    [],
    [
    "Kingston",
    "Kingston",
    "Kingston",
    "Kingston",
    "Kingston",
    "Kingston",
    "Kingston",
    "Kingston"
    ]
];
export const DDC_objectsMoodValues = [
    [],
    [
        ["165°", "Gibbosa calante", "Bassa marea"],
        ["160°", "Luna piena", "Alta marea"],
        ["155°", "Gibbosa crescente", "Bassa marea"],
        ["280°", "Primo quarto", "Bassa marea"],
        ["205°", "Luna calante", "Alta marea"],
        ["200°", "Ultimo quarto", "Bassa marea"],
        ["170°", "Gibbosa crescente", "Bassa marea"],
        ["290°", "Gibbosa calante", "Bassa marea"],
    ]
];

export const DDC_INTERVAL_MOON = 7 * 24 * 60 * 60 * 1000; // 7 giorni
export const DDC_INTERVAL_TIDE = 6 * 60 * 60 * 1000; // 6 ore
export const DDC_INTERVAL_EARTH = 20 * 60 * 1000; // 20 minuti

export const DDC_MIN_DURATION_MINUTES = 20;
export const DDC_MAX_DURATION_MINUTES = 360;
export const DDC_DURATION_RANGE_SIZE = DDC_MAX_DURATION_MINUTES - DDC_MIN_DURATION_MINUTES + 1;

export const DDC_EPOCH_START_MS = new Date('1992-12-04T00:00:00Z').getTime();

export let DDC_currentMood = 0;

function DDC_getDuration(DDC_dateInput = Date.now()) {
    // Usiamo una costante diversa (salt) all'inizio per differenziare l'output da quello della funzione di generazione dei mood, anche con gli stessi indici.
    const DDC_DURATION_SALT = 987654321; // Un numero arbitrario diverso da 0
    let DDC_hash = (DDC_getEarthValue(DDC_dateInput) ^ DDC_DURATION_SALT) | 0; // Inizia con l'indice che cambia più spesso. '| 0' forza a intero 32bit.
    DDC_hash = Math.imul(DDC_hash ^ DDC_getTideValue(DDC_dateInput), 2654435761); // Moltiplica per una costante dopo XOR con la marea
    DDC_hash = Math.imul(DDC_hash ^ DDC_getMoonValue(DDC_dateInput), 2654435761); // Ripeti per le fasi lunari

    DDC_hash = DDC_hash ^ (DDC_hash >>> 16);
    DDC_hash = Math.imul(DDC_hash, 2246822507);
    DDC_hash = DDC_hash ^ (DDC_hash >>> 13);
    DDC_hash = Math.imul(DDC_hash, 3266489909);
    DDC_hash = DDC_hash ^ (DDC_hash >>> 16);

    const DDC_randomValue = (DDC_hash >>> 0) / 4294967296; // Valore [0, 1)

    // Mappiamo il valore [0, 1) all'intervallo intero desiderato.
    // Moltiplichiamo per il numero di valori possibili (221) e aggiungiamo il minimo (20).
    return Math.floor(DDC_randomValue * DDC_DURATION_RANGE_SIZE) + DDC_MIN_DURATION_MINUTES;
}

export function DDC_getCurrentTimesliceDetails(DDC_targetTimeMs = Date.now()) {
    // Per il calcolo parto da una data più vicina del suo compleanno
    const DDC_REF_TIME = new Date('2025-04-25T00:00:00Z').getTime();
    if (DDC_targetTimeMs < DDC_REF_TIME) {
        return null;
    }

    let DDC_currentPeriodStartTimeMs = DDC_REF_TIME;
    let DDC_loopSafetyCounter = 0; // Per prevenire cicli infiniti imprevisti
    const DDC_MAX_LOOPS = 1000000; // Limite ragionevole, dipende da quanto è vecchia l'epoca

    while (DDC_currentPeriodStartTimeMs <= DDC_targetTimeMs && DDC_loopSafetyCounter < DDC_MAX_LOOPS) {
        DDC_loopSafetyCounter++;

        // 1. Calcola indici per l'INIZIO del periodo corrente
        const DDC_indices = {DDC_indexA: DDC_getEarthValue(DDC_currentPeriodStartTimeMs), DDC_indexB: DDC_getTideValue(DDC_currentPeriodStartTimeMs), DDC_indexC: DDC_getMoonValue(DDC_currentPeriodStartTimeMs)};

        // 2. Calcola Mood e Durata per questo periodo (usando gli indici di inizio)
        const DDC_periodMood = DDC_generateMood(DDC_currentPeriodStartTimeMs);
        const DDC_periodDurationMinutes = DDC_getDuration(DDC_currentPeriodStartTimeMs);
        const DDC_periodDurationMs = DDC_periodDurationMinutes * 60 * 1000;

        // Controllo di sicurezza per durata non valida
        if (DDC_periodDurationMs <= 0) {
            return null; // O gestisci diversamente
        }

        // 3. Calcola l'ora di fine di questo periodo
        const DDC_currentPeriodEndTimeMs = DDC_currentPeriodStartTimeMs + DDC_periodDurationMs;

        // 4. Verifica se il targetTimeMs cade DENTRO questo periodo [startTime, endTime)
        if (DDC_targetTimeMs < DDC_currentPeriodEndTimeMs) {
            // Trovato! Questo è il timeslice attivo.
            return {
                //DDC_activeMood: DDC_periodMood,
                DDC_activeMood: 2,
                DDC_startTimeMs: DDC_currentPeriodStartTimeMs,
                DDC_endTimeMs: DDC_currentPeriodEndTimeMs,
                DDC_durationMinutes: DDC_periodDurationMinutes,
                DDC_durationMs: DDC_periodDurationMs,
                DDC_targetTimeMs: DDC_targetTimeMs, // Ora richiesta
                DDC_startTimestamp: new Date(DDC_currentPeriodStartTimeMs), // Ora di inizio come oggetto Date
                DDC_endTimestamp: new Date(DDC_currentPeriodEndTimeMs)      // Ora di fine come oggetto Date
            };
        }

        // 5. Se non è questo il periodo, avanza al prossimo
        // Il nuovo inizio è la fine del periodo appena calcolato
        DDC_currentPeriodStartTimeMs = DDC_currentPeriodEndTimeMs;
    }

    // Se usciamo dal ciclo while senza aver trovato il periodo (es. superato MAX_LOOPS)
    if (DDC_loopSafetyCounter >= DDC_MAX_LOOPS) {
        console.error("Simulazione interrotta: raggiunto limite massimo di iterazioni.");
    } else {
        // Questo caso dovrebbe essere raro se targetTimeMs >= EPOCH_START_MS
        console.error("Simulazione terminata senza trovare un periodo attivo (caso imprevisto).");
    }
    return null;
}

/**
 * Funzione per ottenere il valore della luna
 */
export function DDC_getMoonValue(DDC_dateInput = Date.now()) {
    const DDC_currentTimeMs = DDC_dateInput;
    const DDC_elapsedTimeMs = DDC_currentTimeMs - DDC_EPOCH_START_MS;
    return Math.floor(DDC_elapsedTimeMs / DDC_INTERVAL_MOON);
}

function DDC_generateMood(DDC_dateInput = Date.now()) {
    // Combiniamo gli indici in un singolo valore intero a 32 bit.
    let DDC_hash = DDC_getEarthValue(DDC_dateInput) | 0; // Inizia con l'indice che cambia più spesso. '| 0' forza a intero 32bit.
    DDC_hash = Math.imul(DDC_hash ^ DDC_getTideValue(DDC_dateInput), 2654435761); // Moltiplica per una costante dopo XOR con la marea
    DDC_hash = Math.imul(DDC_hash ^ DDC_getMoonValue(DDC_dateInput), 2654435761); // Ripeti per la luna

    // Applichiamo ulteriori passaggi di mescolamento per aumentare la casualità apparente.
    DDC_hash = DDC_hash ^ (DDC_hash >>> 16); // XOR con se stesso shiftato a destra
    DDC_hash = Math.imul(DDC_hash, 2246822507); // Moltiplica per un primo grande
    DDC_hash = DDC_hash ^ (DDC_hash >>> 13); // Altro XOR shift
    DDC_hash = Math.imul(DDC_hash, 3266489909); // Altro primo grande
    DDC_hash = DDC_hash ^ (DDC_hash >>> 16); // XOR shift finale

    // A questo punto, 'hash' è un intero a 32 bit pseudo-casuale basato sugli indici iniziali.

    // Convertiamo l'hash intero (trattato come unsigned) in un numero decimale [0, 1).
    // `>>> 0` converte l'hash (potenzialmente negativo in JS) in un intero unsigned a 32 bit.
    // Dividiamo poi per 2^32 (4294967296).
    const DDC_randomValue = (DDC_hash >>> 0) / 4294967296;

    // Mappiamo il valore [0, 1) all'intervallo intero desiderato [1, 5].
    const DDC_resultD = Math.floor(DDC_randomValue * 5) + 1;

    return DDC_resultD;
}

/**
   * Ottengo il valore letterale attuale della fase lunare basandosi sul giorno
   * @param {*} DDC_dateInput 
   * @returns 
   */
export function DDC_getLiteralMoonValue(DDC_dateInput = Date.now()) {
    // Ottengo i componenti dell'orario basandomi sulla zona 'Europe/Rome'
    const DDC_options = {
        day: 'numeric',      // 'numeric' per ottenere il valore numerico (es. 9, 15)
        timeZone: 'Europe/Rome'
    };

    // Uso formatToParts per ottenere i singoli componenti (ora, minuti) in modo affidabile
    const DDC_parts = new Intl.DateTimeFormat('it-IT', DDC_options).formatToParts(DDC_dateInput);

    let DDC_dayOfMonth = 0;
    DDC_parts.forEach(DDC_part => {
        if (DDC_part.type === 'day') {
            DDC_dayOfMonth = parseInt(DDC_part.value, 10); // Converte la stringa dell'ora in numero intero
        }
    });

    if(DDC_dayOfMonth < 4) {
        return "Nuova";
    }
    else if(DDC_dayOfMonth < 8) {
        return "Crescente";
    }
    else if (DDC_dayOfMonth < 12) {
        return "Primo quarto";
    }
    else if(DDC_dayOfMonth < 16) {
        return "Gibbosa crescente";
    }
    else if(DDC_dayOfMonth < 20) {
        return "Piena";
    }
    else if(DDC_dayOfMonth < 24) {
        return "Gibbosa calante";
    }
    else if(DDC_dayOfMonth < 28) {
        return "Ultimo quarto";
    }
    else return "Calante";
}

/**
 * Funzione per ottenere il valore delle maree
 */
export function DDC_getTideValue(DDC_dateInput = Date.now()) {
    const DDC_currentTimeMs = DDC_dateInput;
    const DDC_elapsedTimeMs = DDC_currentTimeMs - DDC_EPOCH_START_MS;
    return Math.floor(DDC_elapsedTimeMs / DDC_INTERVAL_TIDE);
}

/**
 * Ottengo il valore letterale attuale della marea basandosi sull'ora
 * @param {*} DDC_dateInput 
 * @returns 
 */
export function DDC_getLiteralTideValue(DDC_dateInput = Date.now()) {
    // Ottengo i componenti dell'orario basandomi sulla zona 'Europe/Rome'
    const DDC_options = {
        hour: 'numeric',      // 'numeric' per ottenere il valore numerico (es. 9, 15)
        timeZone: 'Europe/Rome'
    };

    // Uso formatToParts per ottenere i singoli componenti (ora, minuti) in modo affidabile
    const DDC_parts = new Intl.DateTimeFormat('it-IT', DDC_options).formatToParts(DDC_dateInput);

    let DDC_hour = 0;
    // Calcolo l'ora attuale
    DDC_parts.forEach(DDC_part => {
        if (DDC_part.type === 'hour') {
            DDC_hour = parseInt(DDC_part.value, 10); // Converte la stringa dell'ora in numero intero
        }
    });

    // Se è notte o pomeriggio ho alta marea
    if(DDC_hour < 6 || (DDC_hour >= 12 && DDC_hour < 18)) {
        return "Alta";
    }
    return "Bassa";
}

/**
 * Funzione per ottenere il valore della terra
 */
export function DDC_getEarthValue(DDC_dateInput = Date.now()) {
    const DDC_currentTimeMs = DDC_dateInput;
    const DDC_elapsedTimeMs = DDC_currentTimeMs - DDC_EPOCH_START_MS;
    return Math.floor(DDC_elapsedTimeMs / DDC_INTERVAL_EARTH);
}

 /**
 * Funzione per ottenere il valore effettivo in parole della rotazione terrestre basandosi sull'orario attuale
 * @param {*} DDC_dateInput 
 * @returns 
 */
export function DDC_getLiteralEarthValue(DDC_dateInput = Date.now()) {
    // Ottengo i componenti dell'orario basandomi sulla zona 'Europe/Rome'
    const DDC_options = {
        hour: 'numeric',      // 'numeric' per ottenere il valore numerico (es. 9, 15)
        minute: 'numeric',    // 'numeric' per ottenere il valore numerico (es. 5, 30)
        timeZone: 'Europe/Rome'
    };

    // Uso formatToParts per ottenere i singoli componenti (ora, minuti) in modo affidabile
    const DDC_parts = new Intl.DateTimeFormat('it-IT', DDC_options).formatToParts(DDC_dateInput);

    let DDC_hour = 0;
    let DDC_minute = 0;

    // Itero sui componenti per estrarre l'ora e i minuti
    DDC_parts.forEach(DDC_part => {
        if (DDC_part.type === 'hour') {
            DDC_hour = parseInt(DDC_part.value, 10); // Converte la stringa in numero intero
        } else if (DDC_part.type === 'minute') {
            DDC_minute = parseInt(DDC_part.value, 10); // Converte la stringa in numero intero
        }
    });

    // Calcolo i minuti totali trascorsi dall'inizio del giorno
    const DDC_totalMinutesToday = (DDC_hour * 60) + DDC_minute;
    // Calcolo il numero di rotazioni di 5 gradi dividendo per 20 (tempo in minuti per ruotare di 5 gradi)
    return Math.floor(DDC_totalMinutesToday / 20) * 5;
}

/**
 * Funzione per l'aggiornamento dell'ora del label nel footer
 */
export function DDC_updateTime() {
    const DDC_now = new Date();
    const DDC_hours = String(DDC_now.getHours()).padStart(2, '0');
    const DDC_minutes = String(DDC_now.getMinutes()).padStart(2, '0');
    const DDC_seconds = String(DDC_now.getSeconds()).padStart(2, '0');
    const DDC_timeString = `${DDC_hours}:${DDC_minutes}:${DDC_seconds}`;

    // Trovo l'elemento di testo tramite il suo ID
    const DDC_timeLabel = document.getElementById('footer-time-label');

    // Aggiorna il testo dell'elemento
    if (DDC_timeLabel) {
        DDC_timeLabel.textContent = DDC_timeString;
    }
}